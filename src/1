# -*- coding: utf-8 -*-
import os.path
import docker
from pprint import pprint

def getDockerFile(path):
    return fpath = os.path.realpath('.').replace('/src', '') + path

def full(img='solr4'):
    solr_path = '/Users/albertvico/work/solr4/'
    fpath = getDockerFile('/conf/solr4')
    client = docker.from_env(assert_hostname=False)
    response = [l for l in client.build(fpath, tag=img)]
    pprint(response)
    container = client.create_container(
        image=img,
        name='solr',
        volumes=['/opt/solr'],
        host_config=client.create_host_config(binds={
            solr_path: {
                'bind': '/opt/solr',
                'mode': 'rw',
                }}))
    pprint(container['Id'])
    status = client.start(container['Id'])
    pprint(status)
    # client.delete(container['Id'])

def min(img='solr4min'):
    war_path = '/Users/albertvico/deploy/'
    f_path = getDockerFile('/conf/solr4-min')
    client = docker.from_env(assert_hostname=False)
    response = [l for l in client.build(f_path, tag=img)]
    pprint(response)
    container = client.create_container(
        image=img,
        name='solr',
        volumes=['/opt/solr'],
        host_config=client.create_host_config(binds={
            solr_path: {
                'bind': '/opt/solr',
                'mode': 'rw',
                }}))
    pprint(container['Id'])
    status = client.start(container['Id'])
    pprint(status)

min()
